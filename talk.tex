\documentclass[11pt]{beamer}

\usecolortheme[light,accent=blue]{solarized}
\setbeamercovered{transparent=0}
\setbeamertemplate{navigation symbols}{} % remove navigation symbols
\setbeamertemplate{section in toc}[sections numbered] % numbered sections
% \setbeamertemplate{footline}[page number]
\setbeamertemplate{footline}{
  \hfill%
  \usebeamercolor[fg]{page number in head/foot}%
  \usebeamerfont{page number in head/foot}%
  \setbeamertemplate{page number in head/foot}[framenumber]%
  \usebeamertemplate*{page number in head/foot}\kern1em\vskip2pt%
}
\setbeamerfont{page number in head/foot}{size=\small}
\setbeamerfont{note page}{size=\scriptsize}
\addtobeamertemplate{note page}{\setbeamerfont{itemize/enumerate subbody}{size=\tiny}}{}
\setbeamertemplate{bibliography item}{\insertbiblabel}

\usepackage[english]{babel}
% \usepackage{times}
% \usepackage{esvect}\renewcommand{\vec}[1]{\vv{#1}}
% \usepackage{setspace}\setstretch{1.5}
\usepackage{amsmath,amssymb}
\usepackage{physics}
\usepackage{slashed}
\usepackage{tikz}
\usepackage{pgfplots}\pgfplotsset{compat=1.17}
\usepackage{listings}
\usepackage{siunitx}
\usepackage[backend=biber,natbib=true,style=numeric,sorting=none]{biblatex}
% \usepackage{multimedia}

\addbibresource{talk.bib}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\usetikzlibrary{calc,decorations.markings,decorations.pathmorphing,positioning,shapes,scopes}

\tikzset{
  >=latex,
  ->-/.style={postaction={decorate},decoration={%
      markings,mark=at position #1 with {\arrow{>}}%
    }%
  },%
  ->-/.default=.5,
  -<-/.style={postaction={decorate},decoration={%
      markings,mark=at position #1 with {\arrowreversed{>}}%
    }%
  },%
    -<-/.default=.5,
  % use option [visible on=<+->] to uncover parts of a tikzpicture
  invisible/.style={opacity=0},
  visible on/.style={alt=#1{}{invisible}},
  alt/.code args={<#1>#2#3}{%
    \alt<#1>{\pgfkeysalso{#2}}{\pgfkeysalso{#3}} % \pgfkeysalso doesn't change the path
  },
  photon/.style={decorate, decoration={snake, segment length=3mm, amplitude=0.8mm}},
}

% arrows on the field lines
\tikzstyle directed=[postaction={decorate,decoration={markings,
  mark=at position .2 with {\arrowreversed[scale=1.5]{>}},
  mark=at position .8 with {\arrowreversed[scale=1.5]{>}}}}]

% field lines
\tikzstyle fLines=[thick,directed]

\tikzset{xcenter around/.style 2 args={execute at end picture={%
  \useasboundingbox let \p0 = (current bounding box.south west), \p1 = (current bounding box.north east),
                        \p2 = (#1), \p3 = (#2)
                    in
        ({min(\x2 + \x3 - \x1,\x0)},\y0) rectangle ({max(\x3 + \x2 - \x0,\x1)},\y1);
}}}

\lstset{
  backgroundcolor=\color{white},   % choose the background color; you must add \usepackage{color} or \usepackage{xcolor}; should come as last argument
  basicstyle=\footnotesize\ttfamily,        % the size of the fonts that are used for the code
  breaklines=true,                 % sets automatic line breaking
  stepnumber=1,
  prebreak=\textbackslash,
  commentstyle=\color{gray},       % comment style
  % deletekeywords={...},            % if you want to delete keywords from the given language
  % escapeinside={\%*}{*)},          % if you want to add LaTeX within your code
  % extendedchars=true,              % lets you use non-ASCII characters; for 8-bits encodings only, does not work with UTF-8
  frame=single,	                   % adds a frame around the code
  keepspaces=true,                 % keeps spaces in text, useful for keeping indentation of code (possibly needs columns=flexible)
  keywordstyle=\color{blue},       % keyword style
  morekeywords={wget},             % if you want to add more keywords to the set
  numbers=left,                    % where to put the line-numbers; possible values are (none, left, right)
  numbersep=5pt,                   % how far the line-numbers are from the code
  numberstyle=\tiny\color{gray},   % the style that is used for the line-numbers
  rulecolor=\color{gray},         % if not set, the frame-color may be changed on line-breaks within not-black text (e.g. comments (green here))
  showspaces=false,                % show spaces everywhere adding particular underscores; it overrides 'showstringspaces'
  showstringspaces=false,          % underline spaces within strings only
  showtabs=false,                  % show tabs within strings adding particular underscores
  % stringstyle=\color{red},         % string literal style
  tabsize=2,	                   % sets default tabsize to 2 spaces
}

\newcommand{\CXX}{\texttt{C++}}
\newcommand{\FORTRAN}{\texttt{FORTRAN}}
\newcommand{\FlexibleSUSY}{\texttt{FlexibleSUSY}}
\newcommand{\HiggsTools}{\texttt{HiggsTools}}
\newcommand{\ii}{\text{i}}
\newcommand{\hc}{\text{h.c.}}
\newcommand{\Lagr}{\mathcal{L}}
\newcommand{\Lagrin}{\mathcal{L}_{\text{int}}}
\newcommand{\LoopTools}{\texttt{LoopTools}}
\newcommand{\Mathematica}{\texttt{Mathematica}}
\newcommand{\micrOMEGAs}{\texttt{micrOMEGAs}}
\newcommand{\SARAH}{\texttt{SARAH}}
\newcommand{\SESM}{\text{SESM}}
\newcommand{\SM}{\text{SM}}
\newcommand{\SPheno}{\texttt{SPheno}}

\newcommand{\SMtable}{%
    \begin{tikzpicture}[node distance = 2.5em, auto]
      \node[quark] (u) {$u$};
      \node[quark, below of=u] (d) {$d$};
      \node[quark, right of=u] (c) {$c$};
      \node[quark, below of=c] (s) {$s$};
      \node[quark, right of=c] (t) {$t$};
      \node[quark, below of=t] (b) {$b$};
      \node[lepton, below of=d] (ne) {$\nu_e$};
      \node[lepton, below of=ne] (e) {$e$};
      \node[lepton, right of=ne] (nm) {$\nu_\mu$};
      \node[lepton, below of=nm] (m) {$\mu$};
      \node[lepton, right of=nm] (nt) {$\nu_\tau$};
      \node[lepton, below of=nt] (ta) {$\tau$};
      \node[gauge, right of=t] (gamma) {$\gamma$};
      \node[gauge, below of=gamma] (g) {$g$};
      \node[gauge, below of=g] (Z) {$Z$};
      \node[gauge, below of=Z] (W) {$W$};
      \node[scalar, right of=W] (H) {$h$};
      \node[rotate=90] (quarks)  at ($(u)!0.5!(d)+(-1,0)$)  {quarks};
      \node[rotate=90] (leptons) at ($(ne)!0.5!(e)+(-1,0)$) {leptons};
      \node[below of=H] (higgs) {Higgs};
      \node[above of=gamma, align=center] (gauge) {gauge\\[-0.5em] bosons};
    \end{tikzpicture}
}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\tikzstyle{block} = [rectangle, draw, text width=7em, text centered, minimum height=2em]

\tikzstyle{quark}     = [rectangle, black, draw, fill=yellow, minimum width=2em, text centered, minimum height=2em]
\tikzstyle{lepton}    = [rectangle, black, draw, fill=red!50, minimum width=2em, text centered, minimum height=2em]
\tikzstyle{gauge}     = [circle   , black, draw, fill=green , minimum size=2em, inner sep=0pt, text centered]
\tikzstyle{scalar}    = [diamond  , black, draw, fill=blue!40, minimum width=2.3em, text centered, minimum height=2.3em, inner sep=0pt]
\tikzstyle{goldstone} = [diamond  , black, draw, dashed, fill=blue!30, minimum width=2.3em, text centered, minimum height=2.3em, inner sep=0pt]
\tikzstyle{squark}    = [diamond  , black, draw, fill=yellow, minimum width=2.3em, text centered, minimum height=2.3em, inner sep=0pt]
\tikzstyle{slepton}   = [diamond  , black, draw, fill=red!50, minimum width=2.3em, text centered, minimum height=2.3em, inner sep=0pt]
\tikzstyle{gaugino}   = [rectangle, black, draw, fill=green , minimum size=2em, inner sep=0pt, text centered]
\tikzstyle{higgsino}  = [rectangle, black, draw, fill=blue!40  , minimum width=2em, text centered, minimum height=2em]
\tikzstyle{inert}     = [diamond  , black, draw, fill=teal!80, minimum width=2.3em, text centered, minimum height=2.3em, inner sep=0pt]
\tikzstyle{inertino}  = [rectangle, black, draw, fill=teal!80, minimum width=2em, text centered, minimum height=2em]
\tikzstyle{phantom}   = [rectangle, black, minimum width=2em, text centered, minimum height=2em]

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\definecolor{red}{rgb}{1.0,0.2,0.2}
\definecolor{blue}{rgb}{0,0.7,1.0}
\definecolor{green}{rgb}{0,1.0,0.5}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\title{Tools for HEP}
\subtitle{From $\Lagr$ to Observables}

\author[Voigt]{Alexander Voigt}
\institute[RWTH Aachen]{RWTH Aachen}
\date{Workshop on ``Selected topics on future directions in particle physics'', Warsaw 2024}

\begin{document}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{frame}
  \titlepage
\end{frame}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{frame}{Table of Contents}
  \tableofcontents
\end{frame}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\section{Overview}

\begin{frame}{Overview}
  \begin{center}
    \begin{tikzpicture}[node distance=1.5em, auto]
      \node[block] (L) { Lagrangian $\Lagr$ };
      \node[block, below=of L] (E) { expressions for vertices, $M_f$, $\Sigma_f$, $\beta_i$, \ldots };
      \node[block, left=of E] (S) { \SPheno };
      \node[block, below=of S] (SO) { values for $m_f$, $\Gamma$, $a_\mu$, \ldots };
      \node[block, right=of E] (F) { \FlexibleSUSY };
      \node[block, below=of F] (FO) { values for $m_f$, $\Gamma$, $a_\mu$, \ldots };
      \node[block, below=4em of E] (O) { \micrOMEGAs, \HiggsTools, \ldots };
      \node[block, below=of O] (O2) { values for $\Omega h^2$, $\chi^2$, \ldots };
      \draw[->] (L) -- node[right] { \SARAH } (E);
      \draw[->] (E) -- (S);
      \draw[->] (E) -- (F);
      \draw[->] (S) -- (SO);
      \draw[->] (F) -- (FO);
      \draw[->] (SO) |- (O);
      \draw[->] (FO) |- (O);
      \draw[->] (E) -- (O);
      \draw[->] (O) -- (O2);
    \end{tikzpicture}
  \end{center}
\end{frame}

\note{
  \begin{itemize}
  \item Start with picture of the galaxy cluster ``Abell 1689'' from the Hubble telescope
  \item look closely: you'll see a gravity lens effect
  \item So, there must be some massive object(s) between the galaxy
    cluster and us.
  \item If one counts the number of visible objects (stars), one finds
    that (assuming ART is correct), the cumulative mass of the stars
    is not enough to explain this gravity lens effect.
  \item So, there must be some invisible massive matter between the
    galaxy cluster and us. This is what astronomers and cosmologists
    call ``Dark Matter''.
  \end{itemize}
}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

% \section{Setup}
% \subsection{Mathematica}

% \begin{frame}[fragile]{\insertsection\ -- Mathematica}
%   \begin{enumerate}
%   \item Get a free licence for WolframEngine:
%     \begin{center}
%       \url{https://www.wolfram.com/engine/free-license/}
%     \end{center}
%   \item Download an install WolframEngine 14.1 from:
%     \begin{center}
%       \url{https://www.wolfram.com/engine/}
%     \end{center}
%   \item Ensure the Wolfram Language Kernel can be called from the
%     command line by running \texttt{math}:
%     \begin{lstlisting}[language=sh]
% $PATH=$PATH:/usr/local/Wolfram/WolframEngine/14.1/Executables/\end{lstlisting}
%   \item Test it:
%     \begin{lstlisting}
% math -run "Print[Hello World]; Quit[]"\end{lstlisting}
%   \end{enumerate}
% \end{frame}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

% \subsection{SARAH}

% \begin{frame}[fragile]{\insertsection\ -- \SARAH\ 4.15.2}
%   \textbf{Goal:} The following command should work:
%   \begin{lstlisting}
% math -run "<< SARAH\`"\end{lstlisting}
%   It should print (or similar):
%   \begin{lstlisting}[basicstyle=\scriptsize\ttfamily]
% Wolfram Language 14.1.0 Engine for Linux x86 (64-bit)
% Copyright 1988-2023 Wolfram Research, Inc.

% SARAH 4.15.2
% by Florian Staub, Mark Goodsell and Werner Porod, 2020
% contributions by M. Gabelmann, K. Nickel\end{lstlisting}
% \end{frame}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

% \begin{frame}[fragile]{\insertsection\ -- \SARAH\ 4.15.2}
%   \textbf{Method 1:} automatic download and installation:
%   \begin{lstlisting}[language=sh,basicstyle=\scriptsize\ttfamily]
% wget https://raw.githubusercontent.com/FlexibleSUSY/FlexibleSUSY/development/install-sarah
% chmod +x install-sarah
% ./install-sarah --flavour=WolframEngine\end{lstlisting}
%   \textbf{Method 2:} manual download:
%   \begin{lstlisting}[language=sh,basicstyle=\scriptsize\ttfamily]
% cd ~/.WolframEngine/Applications
% wget https://sarah.hepforge.org/downloads/SARAH-4.15.2.tar.gz
% tar -xf SARAH-4.15.2.tar.gz
% ln -s SARAH-4.15.2 SARAH\end{lstlisting}
%   and installation:
%   \begin{lstlisting}[language=sh,basicstyle=\scriptsize\ttfamily]
% cd ~/.WolframEngine/Kernel
% echo 'AppendTo[$Path, FileNameJoin[{$HomeDirectory, ".WolframEngine", "Applications", "SARAH"}]];' >> init.m
% \end{lstlisting}%$
% \end{frame}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

% \subsection{Compilers and Libraries}

% \begin{frame}[fragile]{\insertsection\ -- compilers and libraries}
%   \textbf{Requirements:} \CXX\ compiler, \FORTRAN\ compiler, BOOST
%   library, Eigen3 library, GNU Scientific Library

%   \bigskip

%   Installation on \textbf{Ubuntu}:
%   \begin{lstlisting}[language=sh]
% sudo apt install gcc g++ gfortran libboost-dev libeigen3-dev libgsl-dev dpkg-dev\end{lstlisting}
%   %
%   Installation on \textbf{MacOS}:
%   \begin{lstlisting}[language=sh]
% brew install gcc boost eigen gsl\end{lstlisting}
% \end{frame}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

% \subsection{FlexibleSUSY}

% \begin{frame}[fragile]{\insertsection\ -- \FlexibleSUSY}
%   \begin{lstlisting}[language=sh]
% wget https://flexiblesusy.hepforge.org/downloads/FlexibleSUSY-2.8.0.tar.gz
% tar -xf FlexibleSUSY-2.8.0.tar.gz
% cd FlexibleSUSY-2.8.0\end{lstlisting}%$
% \end{frame}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\section{Standard Model}

% \begin{frame}{\insertsection\ (SM)}
%   Interaction Lagrangian in terms of Weyl 2-Spinors:
%   \begin{align*}
%     \Lagrin
%     &= \qty[-Y^d_{ij} H_a^* d_iq_{aj} - Y^e_{ij} H_a^* e_i\ell_{aj} - Y^u_{ij} u_iq_{aj}H_a + \hc] \\
%     &\phantom{=}{} -\mu^2 H_a^* H_a - \frac{1}{2} (H_a^* H_a)^2
%   \end{align*}
% \end{frame}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{frame}[fragile]{\insertsection\ -- What we will do}
  \begin{enumerate}
  \item Inspect the \SARAH\ model files and generate some analytic
    expressions
  \item Create a \SPheno\ spectrum generator
  \item Create a \FlexibleSUSY\ spectrum generator
  \end{enumerate}
\end{frame}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\subsection{SARAH}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{frame}[fragile]{\insertsection\ -- SARAH -- inspect model files}

  Go to the \SARAH\ directory:
  %
  \begin{lstlisting}
$ cd ~/hep-software/SARAH\end{lstlisting}%$
  %
  Let's inspect the following \SARAH\ files:
  \begin{itemize}
  \item \texttt{Models/SM/SM.m}\\ Definitions of the gauge
    group, fields, Lagrangian, VEVs, field mixings, \ldots
  \item \texttt{Models/SM/particles.m}\\
    Definitions of properties of the fields (output name, \LaTeX\
    name, PDG number, FeynArts number, \ldots)
  \item \texttt{Models/SM/parameters.m}\\
    Definitions of information about the model parameters (Output
    name, \LaTeX\ name, SLHA output block, \ldots)
  \end{itemize}

  \bigskip

  References: \url{https://sarah.hepforge.org/}
\end{frame}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{frame}[fragile]{\insertsection\ -- SARAH -- inspect model properties}
  Let's start \SARAH\ and inspect some model properties.

  \medskip

%   Go to \texttt{$\sim$/hep-software/SARAH}:
%   \begin{lstlisting}
% $ cd ~/hep-software/SARAH\end{lstlisting}%$
  %
  Start \Mathematica:
  \begin{lstlisting}
$ math\end{lstlisting}%$
  %
  Run
  %
  \begin{lstlisting}
In[]:= << SARAH`
In[]:= << Start["SM"]
In[]:= SARAH`Commands (* shows available commands *)\end{lstlisting}
  %
  Let's inspect some model properties:
  %
  \begin{lstlisting}
In[]:= SARAHparameters (* parameters *)
In[]:= Particles[EWSB] (* fields after EWSB *)
In[]:= MassMatrix[Fe]  (* mass matrix of Fe *)
In[]:= Vertex[{bar[Fe],Fe,VP}] (* a vertex *)\end{lstlisting}
\end{frame}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{frame}[fragile]{\insertsection\ -- SARAH -- generate some expressions}
  Let's  generate some analytic expressions.
  %
  \begin{lstlisting}
In[]:= MakeAll[] (* generate all expressions *)
In[]:= Quit[] (* quit *)\end{lstlisting}
  %
  The expressions are written to the \texttt{Output/SM/} sub-directory.

  \medskip

  Vertices (fermion--fermion--gauge boson):
  %
  \begin{lstlisting}
$ less Output/SM/EWSB/Vertices/VertexListFFV.m\end{lstlisting}%$
  %
  Beta functions (gauge couplings):
  %
  \begin{lstlisting}
$ less Output/SM/RGEs/BetaGauge.m\end{lstlisting}%$
  %
  1-loop self-energies:
  %
  \begin{lstlisting}
$ less Output/SM/EWSB/One-Loop/SelfEnergy.m\end{lstlisting}%$
\end{frame}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\subsection{SPheno}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{frame}[fragile]{\insertsection\ -- SPheno -- spectrum generator}
  Let's create a \SPheno\ spectrum generator for the SM.

  \bigskip

  Let's first look into the \SPheno\ model file for the SM:
  %
  \begin{lstlisting}
$ less Models/SM/SPheno.m\end{lstlisting}%$
  %
  It defines boundary conditions for input and output parameters, loop
  corrections, observables, \ldots

  \bigskip

  Now we'll create the FORTRAN source code for the \SPheno\ spectrum
  generator:
  %
  \begin{lstlisting}
$ math
In[]:= << SARAH`
In[]:= Start["SM"]
In[]:= MakeSPheno[]
In[]:= Quit[]\end{lstlisting}%$

\end{frame}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{frame}[fragile]{\insertsection\ -- SPheno -- spectrum generator}
  Now go to the \SPheno\ directory and copy the generated FORTRAN
  files to the \SM\ sub-directory.
  %
  \begin{lstlisting}
$ cd ~/hep-software/SPheno-4.0.5
$ mv ~/hep-software/SARAH/Output/SM/EWSB/SPheno SM\end{lstlisting}%$
  %
  Then we compile the source code:
  %
  \begin{lstlisting}
$ make F90=gfortran
$ make F90=gfortran Model=SM\end{lstlisting}%$
  %
  Now we can run the spectrum generator and inspect the SLHA output file:
  %
  \begin{lstlisting}
$ bin/SPhenoSM SM/Input_Files/LesHouches.in.SM
$ less SPheno.spc.SM\end{lstlisting}
\end{frame}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\subsection{FlexibleSUSY}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{frame}[fragile]{\insertsection\ -- FlexibleSUSY -- spectrum generator}
  Let's now create a \FlexibleSUSY\ spectrum generator for the SM.

  \bigskip

  Go into the FlexibleSUSY-2.8.0 directory:
  \begin{lstlisting}
$ cd ~/hep-software/FlexibleSUSY-2.8.0\end{lstlisting}%$
  %
  Let's first look into the \FlexibleSUSY\ model file for the SM:
  %
  \begin{lstlisting}
$ less model_files/SM/FlexibleSUSY.m.in\end{lstlisting}%$
  %
  It defines boundary conditions for input and output parameters, loop
  corrections, observables, \ldots

  \bigskip

  References:\\
  \url{https://arxiv.org/abs/1406.2319}\\
  \url{https://arxiv.org/abs/1710.03760}

\end{frame}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{frame}[fragile]{\insertsection\ -- FlexibleSUSY -- spectrum generator}
  Now we'll build the \FlexibleSUSY\ spectrum generator for the SM.

  \bigskip

  Define a variable to contain the \LoopTools\ directory
  \begin{lstlisting}
$ LT=$HOME/hep-software/LoopTools/build\end{lstlisting}%$
  Create and build the SM spectrum generator:
  \begin{lstlisting}
$ ./createmodel --name=SM
$ ./configure --with-models=SESM \
     --with-loop-libraries=looptools \
     --with-looptools-incdir=$LT
     --with-looptools-libdir=$LT
$ make -j4\end{lstlisting}%$
  %
  Run the spectrum genrator (set \texttt{FlexibleSUSY[31] = 2}):
  %
  \begin{lstlisting}
$ models/SM/run_SM.x \
    --slha-input-file=models/SM/LesHouches.in.SM\end{lstlisting}%$
\end{frame}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\section{Standard Model + S}

\subsection{SARAH}

\begin{frame}{\insertsection}
  As a second example, let's consider an extension of the SM by an
  extra real scalar gauge singlet. The model should be called Singlet
  Extension of the Standard Model (\SESM).  The Lagrangian should read
  %
  \begin{equation*}
    \Lagr_{\SESM} = \Lagr_{\SM} - \left[\kappa_{SH} H^\dagger H s + \frac{\lambda_{SH}}{2} H^\dagger H s^2 + \frac{M_S^2}{2} s^2 + \frac{\kappa_S}{3} s^3 + \frac{\lambda_S}{2} s^4\right]
  \end{equation*}
  %
  We will proceed as follows:
  %
  \begin{enumerate}
  \item Create a \SARAH\ model file for the SESM
  \item Create a \FlexibleSUSY\ model file for the SESM and run it
  \item Create a \SPheno\ model file for the SESM and run it
  \end{enumerate}
\end{frame}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{frame}[fragile]{\insertsection\ -- SARAH -- model file}
  First, we will create a \SARAH\ model file for our new SESM model.

  \bigskip

  Go into the \SARAH\ directory:
  %
  \begin{lstlisting}
$ cd ~/hep-software/SARAH\end{lstlisting}%$
  %
  We start by copying \SARAH's \SM\ model files to a new directory named
  \texttt{SESM}:
  %
  \begin{lstlisting}
$ mkdir -p Models/SESM
$ cp Models/SM/parameters.m Models/SESM/
$ cp Models/SM/particles.m Models/SESM/
$ cp Models/SM/SM.m Models/SESM/SESM.m\end{lstlisting}%$
\end{frame}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{frame}[fragile]{\insertsection\ -- SARAH -- model file}
  First, we modify \texttt{Models/SESM/SESM.m}:

  \medskip

  1. Add the new scalar field:
  %
  \begin{lstlisting}
ScalarFields[[2]] = {s, 1, Sing, 0, 1, 1};
RealScalars = {s};\end{lstlisting}
  %
  3. Extend the Lagrangian:
  %
  \begin{lstlisting}
LagNoHC = -(
    + mu2 conj[H].H
    + \[Lambda]/2 conj[H].H.conj[H].H
    + KapSH conj[H].H.s
    + LamSH/2 conj[H].H.s.s
    + MS2/2 s.s
    + KapS/3 s.s.s
    + LamS/2 s.s.s.s
);\end{lstlisting}
\end{frame}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{frame}[fragile]{\insertsection\ -- SARAH -- model file}
  4. Give a VEV to the new (real) singlet:
  %
  \begin{equation*}
    s = v_S + \phi_S
  \end{equation*}
  %
  \begin{lstlisting}
DEFINITION[EWSB][VEVs] = {
  {H0, {v, 1/Sqrt[2]},
       {Ah, \[ImaginaryI]/Sqrt[2]},
       {phiH, 1/Sqrt[2]} },
  {Sing, {vS, 1},
         {0, 0},
         {phiS, 1}
};\end{lstlisting}
\end{frame}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{frame}[fragile]{\insertsection\ -- SARAH -- model file}
  5. Mix $\phi_S$ with $\phi_H$:
  %
  \begin{equation*}
    \begin{pmatrix}
      h_1 \\ h_2
    \end{pmatrix}
    =
    Z_H
    % \begin{pmatrix}
    %   (Z_H)_{11} & (Z_H)_{12} \\
    %   (Z_H)_{21} & (Z_H)_{22}
    % \end{pmatrix}
    \begin{pmatrix}
      \phi_H \\ \phi_S
    \end{pmatrix},
    \qquad
    Z_H^T = Z_H
  \end{equation*}
  %
  \begin{lstlisting}
DEFINITION[EWSB][MatterSector] = {
  {{phiH, phiS}, {hh, ZH}},
  {{{dL}, {conj[dR]}}, {{DL,Vd}, {DR,Ud}}},
  {{{uL}, {conj[uR]}}, {{UL,Vu}, {UR,Uu}}},
  {{{eL}, {conj[eR]}}, {{EL,Ve}, {ER,Ue}}}
};\end{lstlisting}
\end{frame}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{frame}[fragile]{\insertsection\ -- SARAH -- model file}
  6. Modify the particle information in
  \texttt{Models/SESM/particles.m}.

  \bigskip

  First, define the new \texttt{Sing} gauge eigenstate
  %
  \begin{lstlisting}
ParticleDefinitions[GaugeES] = {
  {Sing, { Description -> "Singlet",
           PDG -> {0},
           Width -> 0,
           Mass -> Automatic,
           ElectricCharge -> 0,
           FeynArtsNr -> 3,
           LaTeX -> "s",
           OutputName -> "s" }},
  ...
};\end{lstlisting}
\end{frame}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{frame}[fragile]{\insertsection\ -- SARAH -- model file}
  6. \ldots\ continuing \ldots

  \bigskip

  Extend Higgs to be a doublet in mass eigenstates
  %
  \begin{lstlisting}
ParticleDefinitions[EWSB] = {
  {hh, { Description -> "Higgs",
         PDG -> {25,35}, (* <-- two PDG numbers *)
         PDG.IX -> {101000001,101000002} (* <-- *)
       }
  },
  ...
};\end{lstlisting}
\end{frame}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{frame}[fragile]{\insertsection\ -- SARAH -- model file}
  6. \ldots\ continuing \ldots

  \bigskip

  Change the name of the intermediate neutral component of the SM
  Higgs doublet to \texttt{phiH}:
  %
  \begin{lstlisting}
WeylFermionAndIndermediate = {
  {phiH, { PDG -> {0}, (* <-- name changed to phiH *)
           Width -> 0,
           Mass -> Automatic,
           LaTeX -> "H",
           OutputName -> "" }},
  ...
};\end{lstlisting}
\end{frame}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{frame}[fragile]{\insertsection\ -- SARAH -- model file}
  7. Modify the parameter information in
  \texttt{Models/SESM/parameters.m}.

  \bigskip

  Add the new model parameters and their properties
  %
  \begin{lstlisting}
ParameterDefinitions = {
  {ZH, { Description -> "Scalar-Mixing-Matrix" }},
  {\[Alpha],
       { Description -> "Scalar mixing angle" }},
  {vS, { Dependence -> None,
         DependenceNum -> None,
         DependenceOptional -> None,
         DependenceSPheno -> None,
         Real -> True,
         LesHouches -> {HMIX, 51},
         LaTeX -> "vS",
         OutputName -> vS }},
  ...
};\end{lstlisting}
\end{frame}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{frame}[fragile]{\insertsection\ -- SARAH -- model file}
  7. \ldots\ continuing \ldots
  %
  \begin{lstlisting}
ParameterDefinitions = {
  ...
  {MS2, { LaTeX -> "M_S^2",
          Real -> True,
          OutputName -> MS2,
          LesHouches -> {HMIX,30} }},
  {LamS, { LaTeX -> "\\lambda_S",
           Real -> True,
           OutputName -> LamS,
           LesHouches -> {HMIX,31} }},
  {LamSH, { LaTeX -> "\\lambda_{SH}",
            Real -> True,
            OutputName -> LamSH,
            LesHouches -> {HMIX,32} }},
  ...
};\end{lstlisting}
\end{frame}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{frame}[fragile]{\insertsection\ -- SARAH -- model file}
  7. \ldots\ continuing \ldots
  %
  \begin{lstlisting}
ParameterDefinitions = {
  ...
  {KapS, { LaTeX -> "\\kappa_S",
           Real -> True,
           OutputName -> KapS,
           LesHouches -> {HMIX,33} }},
  {KapSH, { LaTeX -> "\\kappa_{SH}",
            Real -> True,
            OutputName -> KapSH,
            LesHouches -> {HMIX,34} }}
};\end{lstlisting}
\end{frame}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{frame}[fragile]{\insertsection\ -- SARAH -- check model}
  8. Check the \SARAH\ model
  %
  \begin{lstlisting}
$ math
In[]:= << SARAH`
In[]:= Start["SESM"]
In[]:= CheckModel[]
In[]:= Quit[]'\end{lstlisting}%$
\end{frame}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\subsection{FlexibleSUSY}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{frame}[fragile]{\insertsection\ -- FlexibleSUSY -- model file}
  Now we turn to create a \FlexibleSUSY\ model file.

  \bigskip

  1. Go to the \FlexibleSUSY\ directory:
  %
  \begin{lstlisting}
$ cd ~/hep-software/FlexibleSUSY-2.8.0\end{lstlisting}%$
  %
  Copy the SM model to a new model directory named \texttt{model\_files/SESM}
  %
  \begin{lstlisting}
$ mkdir -p model_files/SESM
$ cp model_files/SM/FlexibleSUSY.m.in \
    model_files/SESM/
$ cp model_files/SM/LesHouches.in.SM \
     model_files/SESM/LesHouches.in.SESM\end{lstlisting}%$
\end{frame}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{frame}[fragile]{\insertsection\ -- FlexibleSUSY -- model file}
  2. Edit the \FlexibleSUSY\ model file
  \texttt{model\_files/SESM/FlexibleSUSY.m.in}

  \bigskip

  Define new input parameters and the SLHA blocks they are read from:
  %
  \begin{lstlisting}
FSDefaultSARAHModel = SESM; (* SARAH model *)

MINPAR = {};

EXTPAR = {
    {0, Qin},
    {1, QEWSB},
    {2, LambdaIN},
    {3, LamSIN},
    {4, LamSHIN},
    {5, KapSIN},
    {6, KapSHIN},
    {7, vSIN}
};\end{lstlisting}%$
\end{frame}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{frame}[fragile]{\insertsection\ -- FlexibleSUSY -- model file}
  2. \ldots\ continuing \ldots

  \bigskip

  Fix the new parameters at appropriate scales by EWSB and by the
  input values:
  %
  \begin{lstlisting}
EWSBOutputParameters = { mu2, MS2 };

HighScaleInput = {
    {\[Lambda], LambdaIN},
    {LamS, LamSIN},
    {LamSH, LamSHIN},
    {KapS, KapSIN},
    {KapSH, KapSHIN}
};

SUSYScaleInput = {
    {vS, vSIN}
};\end{lstlisting}%$
\end{frame}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{frame}[fragile]{\insertsection\ -- FlexibleSUSY -- build}
  3. Create, configure and compile the FlexibleSUSY spectrum
  generator:
  %
  \begin{lstlisting}
$ LT=$HOME/hep-software/LoopTools/build

$ ./createmodel -f --name=SESM

$ ./configure --with-models=SESM \
     --with-loop-libraries=looptools \
     --with-looptools-incdir=$LT \
     --with-looptools-libdir=$LT

$ make -j4\end{lstlisting}%$
\end{frame}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{frame}[fragile]{\insertsection\ -- FlexibleSUSY -- SLHA input}
  4. Set reasonable values for the input parameters in the SLHA input
  file \texttt{model\_files/SESM/LesHouches.in.SESM}
  %
  \begin{lstlisting}
Block EXTPAR      # Input parameters
    0   1000      # input scale Qin
    1   173.34    # scale QEWSB
    2   0.21      # LambdaIN
    3   0.1       # LamSIN
    4   0.1       # LamSHIN
    5   100       # KapSIN
    6  -100       # KapSHIN
    7   3         # vSIN\end{lstlisting}%$
\end{frame}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{frame}[fragile]{\insertsection\ -- FlexibleSUSY -- run}
  5. Run FlexibleSUSY:
  %
  \begin{lstlisting}
$ models/SESM/run_SESM.x \
    --slha-input-file=model_files/SESM/LesHouches.in.SESM\end{lstlisting}%$
\end{frame}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\subsection{SPheno}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{frame}[fragile]{\insertsection\ -- SPheno -- model file}
  Finally, let's create a \SPheno\ spectrum generator.

  \bigskip

  1. Go to the \SARAH\ directory and copy the model file
  \texttt{SPheno.m} from the SM to the SESM model directory:
  %
  \begin{lstlisting}
$ cd ~/hep-software/SARAH
$ cp Models/SM/SPheno.m Models/SESM/\end{lstlisting}%$
\end{frame}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{frame}[fragile]{\insertsection\ -- SPheno -- model file}
  2. Modify the \texttt{SPheno.m} model file to define new input
  parameters:
  %
  \begin{lstlisting}
MINPAR = {
    {2, LambdaIN},
    {3, LambdaSIN},
    {4, LambdaSHIN},
    {5, KappaSIN},
    {6, KappaSHIN},
    {7, vevSIN}
};\end{lstlisting}%$
\end{frame}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{frame}[fragile]{\insertsection\ -- SPheno -- model file}
  2. \ldots\ continuing \ldots

  \bigskip

  Fix the new parameters by EWSB and the input values :
  %
  \begin{lstlisting}
ParametersToSolveTadpoles = {mu2, MS2};

BoundaryLowScaleInput = {
    {\[Lambda], LambdaIN},
    {LambdaS, LambdaSIN},
    {LambdaSH, LambdaSHIN},
    {KapS, KappaSIN},
    {KapSH, KappaSHIN},
    {vS, vevSIN}
};\end{lstlisting}%$
\end{frame}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{frame}[fragile]{\insertsection\ -- SPheno -- model file}
  3. Create the FORTRAN files for the \SPheno\ spectrum generator:
  %
  \begin{lstlisting}
$ math
In[]:= << SARAH`
In[]:= Start["SESM"]
In[]:= MakeSPheno[]
In[]:= Quit[]'\end{lstlisting}%$
\end{frame}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{frame}[fragile]{\insertsection\ -- SPheno -- model file}
  4. Go to the \SPheno\ directory:
  %
  \begin{lstlisting}
$ cd ~/hep-software/SPheno-4.0.5\end{lstlisting}%$
  %
  Copy the generated FORTRAN files from the \SARAH\ directory to the
  \SPheno\ directory and compile the spectrum generator:
  %
  \begin{lstlisting}
$ mv ~/hep-software/SARAH/Output/SESM/EWSB/SPheno SESM
$ make F90=gfortran
$ make F90=gfortran Model=SESM\end{lstlisting}%$
\end{frame}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{frame}[fragile]{\insertsection\ -- SPheno -- model file}
  5. Set the input parameters to reasonable values in the SLHA input
  file \texttt{SESM/Input\_Files/LesHouches.in.SESM}:
  %
  \begin{lstlisting}
Block MINPAR   # Input parameters 
 2   0.21      # LambdaIN
 3   0.1       # LamSIN
 4   0.1       # LamSHIN
 5   100       # KapSIN
 6  -100       # KapSHIN
 7   3         # vSIN\end{lstlisting}%$
  %
  6. Run the \SPheno\ spectrum generator:
  \begin{lstlisting}
$ ./bin/SPhenoSSM \
     SESM/Input_Files/LesHouches.in.SESM\end{lstlisting}%$
  and inspect the output:
  \begin{lstlisting}
$ less SPheno.spc.SESM\end{lstlisting}%$
\end{frame}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\section{Standard Model + S + S}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{frame}{\insertsection}
  As a second example, let us consider an extension of the SM by an
  extra real scalar gauge singlet. The model should be called Singlet
  Extension of the Standard Model (\SESM).  The Lagrangian should have
  a global $Z_2$ symmetry and should read
  %
  \begin{equation*}
    \Lagr_{\SESM} = \Lagr_{\SM} - \left[\frac{\lambda_{SH}}{2} H^\dagger H s^2 + \frac{M_S^2}{2} s^2 + \frac{\lambda_S}{2} s^4\right]
  \end{equation*}
  %
  We will proceed as follows:
  %
  \begin{enumerate}
  \item Create a \SARAH\ model file for the SESM
  \item Create a \FlexibleSUSY\ model file for the SESM
  \item Create a \micrOMEGAs\ model file for the SESM
  \item Run \FlexibleSUSY\ and pass the output to \micrOMEGAs\ to
    calculate the dark matter relic abundance $\Omega h^2$.
  \end{enumerate}
\end{frame}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{frame}[fragile]{\insertsection\ -- SARAH -- model file}
  First, we modify \texttt{Models/TSESM/TSESM.m}:

  \medskip

  1. Add a global $Z_2$ symmetry and assign the charge $+1$ to each SM
  field:
  %
  \begin{lstlisting}
Global[[1]] = {Z[2], Z2};

Gauge[[1]]={..., 1};
Gauge[[2]]={..., 1};
Gauge[[3]]={..., 1};

FermionFields[[1]] = {..., 1};
FermionFields[[2]] = {..., 1};
FermionFields[[3]] = {..., 1};
FermionFields[[4]] = {..., 1};
FermionFields[[5]] = {..., 1};

ScalarFields[[1]] =  {..., 1};\end{lstlisting}
\end{frame}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{frame}[fragile]{\insertsection\ -- SARAH -- model file}
  %
  2. Add the new scalar field with $Z_2$ charge $-1$:
  %
  \begin{lstlisting}
ScalarFields[[2]] = {s, 1, Sing, 0, 1, 1, -1};
RealScalars = {s};\end{lstlisting}
  %
  3. Extend the Lagrangian:
  %
  \begin{lstlisting}
LagNoHC = -(
    + mu2 conj[H].H
    + \[Lambda]/2 conj[H].H.conj[H].H
    + LamSH/2 conj[H].H.s.s
    + MS2/2 s.s
    + LamS/2 s.s.s.s
);\end{lstlisting}
\end{frame}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{frame}[fragile]{\insertsection\ -- SARAH -- model file}
  4. Give a VEV to the new (real) singlet:
  %
  \begin{equation*}
    s = v_S + \phi_S
  \end{equation*}
  %
  \begin{lstlisting}
DEFINITION[EWSB][VEVs] = {
  {H0, {v, 1/Sqrt[2]},
       {Ah, \[ImaginaryI]/Sqrt[2]},
       {phiH, 1/Sqrt[2]} },
  {Sing, {vS, 1},
         {0, 0},
         {phiS, 1}
};\end{lstlisting}
\end{frame}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{frame}[fragile]{\insertsection\ -- SARAH -- model file}
  5. Mix $\phi_S$ with $\phi_H$:
  %
  \begin{equation*}
    \begin{pmatrix}
      h_1 \\ h_2
    \end{pmatrix}
    =
    Z_H
    % \begin{pmatrix}
    %   (Z_H)_{11} & (Z_H)_{12} \\
    %   (Z_H)_{21} & (Z_H)_{22}
    % \end{pmatrix}
    \begin{pmatrix}
      \phi_H \\ \phi_S
    \end{pmatrix},
    \qquad
    Z_H^T = Z_H
  \end{equation*}
  %
  \begin{lstlisting}
DEFINITION[EWSB][MatterSector] = {
  {{phiH, phiS}, {hh, ZH}},
  {{{dL}, {conj[dR]}}, {{DL,Vd}, {DR,Ud}}},
  {{{uL}, {conj[uR]}}, {{UL,Vu}, {UR,Uu}}},
  {{{eL}, {conj[eR]}}, {{EL,Ve}, {ER,Ue}}}
};\end{lstlisting}
\end{frame}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

% \begin{frame}[allowframebreaks]{References}
%   \printbibliography
% \end{frame}

\end{document}
